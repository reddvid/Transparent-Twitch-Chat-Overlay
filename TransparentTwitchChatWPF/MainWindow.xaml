<Window
    x:Class="TransparentTwitchChatWPF.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:TransparentTwitchChatWPF"
    xmlns:tb="http://www.hardcodet.net/taskbar"
    xmlns:ui="http://schemas.modernwpf.com/2019"
    xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
    Title="Twitch Chat Overlay"
    Width="360"
    Height="530"
    ui:ThemeManager.RequestedTheme="Dark"
    ui:TitleBar.ExtendViewIntoTitleBar="True"
    ui:TitleBar.Style="{DynamicResource AppTitleBarStyle}"
    ui:WindowHelper.UseModernWindowStyle="True"
    AllowsTransparency="True"
    Background="Transparent"
    BorderBrush="Transparent"
    BorderThickness="4"
    Closed="Window_Closed"
    Deactivated="Window_Deactivated"
    Icon="/Icons/twitch_chat2.ico"
    Loaded="Window_Loaded"
    PreviewLostKeyboardFocus="Window_PreviewLostKeyboardFocus"
    ResizeMode="CanResizeWithGrip"
    Topmost="True"
    WindowStyle="None">

    <Window.Resources>
        <Style x:Key="AppTitleBarStyle" TargetType="ui:TitleBarControl">
            <Setter Property="ui:ThemeManager.RequestedTheme" Value="Dark" />
        </Style>
        <SolidColorBrush x:Key="DarkColor" Color="#1d0049" />
    </Window.Resources>

    <Grid Name="mainWindowGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="18" />
        </Grid.RowDefinitions>

        <tb:TaskbarIcon
            Name="taskbarControl"
            IconSource="/Icons/twitch_chat2.ico"
            ToolTipText="Twitch Chat Overlay">
            <!--  Set a simple context menu  -->
            <tb:TaskbarIcon.ContextMenu>
                <ContextMenu x:Name="contextMenu" ui:ThemeManager.RequestedTheme="Dark">
                    <MenuItem Header="Twitch Chat Overlay" IsEnabled="False" />
                    <MenuItem Click="MenuItem_ToggleBorderVisible" Header="Hide/Show Border" />
                    <MenuItem Click="MenuItem_SettingsClick" Header="Settings" />
                    <MenuItem Click="MenuItem_ResetWindowClick" Header="Reset Window" />
                    <MenuItem Click="MenuItem_DevToolsClick" Header="Dev Tools" />
                    <Separator />
                    <MenuItem Click="MenuItem_VisitWebsite" Header="GitHub latest release" />
                    <MenuItem Click="MenuItem_Exit" Header="Exit" />
                </ContextMenu>
            </tb:TaskbarIcon.ContextMenu>
        </tb:TaskbarIcon>

        <Grid
            x:Name="AppTitleBar"
            Grid.Row="0"
            ui:ThemeManager.RequestedTheme="Dark"
            Background="{StaticResource DarkColor}">

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <ui:SimpleStackPanel Grid.Column="0" Orientation="Horizontal">
                <ui:TitleBarButton
                    x:Name="btnSettings"
                    Click="btnSettings_Click"
                    MouseRightButtonUp="btnSettings_MouseRightButtonUp"
                    ToolTip="Menu">
                    <ui:TitleBarButton.ContextMenu>
                        <ContextMenu x:Name="settingsBtnContextMenu" ui:ThemeManager.RequestedTheme="Dark">
                            <MenuItem Header="Twitch Chat Overlay" IsEnabled="False" />
                            <MenuItem
                                x:Name="menuItemToggleBorders"
                                Click="MenuItem_ToggleBorderVisible"
                                Header="Toggle Borders" />
                            <MenuItem Click="MenuItem_ClickNewWindow" Header="New Widget" />
                            <MenuItem Header="Zoom Level">
                                <MenuItem
                                    Click="MenuItem_ZoomIn"
                                    Header="+ Zoom In"
                                    StaysOpenOnClick="True" />
                                <MenuItem
                                    Click="MenuItem_ZoomOut"
                                    Header="- Zoom Out"
                                    StaysOpenOnClick="True" />
                                <MenuItem Click="MenuItem_ZoomReset" Header="Reset" />
                            </MenuItem>
                            <MenuItem Header="Opacity Level">
                                <MenuItem
                                    Click="MenuItem_IncOpacity"
                                    Header="+ Increase"
                                    StaysOpenOnClick="True" />
                                <MenuItem
                                    Click="MenuItem_DecOpacity"
                                    Header="- Decrease"
                                    StaysOpenOnClick="True" />
                                <MenuItem Click="MenuItem_ResetOpacity" Header="Reset" />
                            </MenuItem>
                            <MenuItem Click="MenuItem_ShowSettings" Header="Settings" />
                            <MenuItem Click="MenuItem_DevToolsClick" Header="Dev Tools" />
                            <Separator />
                            <MenuItem
                                x:Name="menuItemToggleInteractable"
                                Click="MenuItem_ToggleInteractable"
                                Header="Toggle Interactable" />
                            <MenuItem
                                x:Name="menuItemBringToTop"
                                Click="MenuItem_BringToTopTimer"
                                Header="Bring To Top" />
                            <Separator />
                            <MenuItem Click="MenuItem_VisitWebsite" Header="GitHub latest release" />
                        </ContextMenu>
                    </ui:TitleBarButton.ContextMenu>
                    <ui:PathIcon
                        Width="16"
                        Height="16"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Data="F1 M 0.625 3.75 C 0.455729 3.75 0.309245 3.688152 0.185547 3.564453 C 0.061849 3.440756 0 3.294271 0 3.125 C 0 2.95573 0.061849 2.809246 0.185547 2.685547 C 0.309245 2.56185 0.455729 2.5 0.625 2.5 L 19.375 2.5 C 19.54427 2.5 19.690754 2.56185 19.814453 2.685547 C 19.93815 2.809246 20 2.95573 20 3.125 C 20 3.294271 19.93815 3.440756 19.814453 3.564453 C 19.690754 3.688152 19.54427 3.75 19.375 3.75 Z M 0.625 10 C 0.455729 10 0.309245 9.938151 0.185547 9.814453 C 0.061849 9.690756 0 9.544271 0 9.375 C 0 9.205729 0.061849 9.059245 0.185547 8.935547 C 0.309245 8.81185 0.455729 8.75 0.625 8.75 L 19.375 8.75 C 19.54427 8.75 19.690754 8.81185 19.814453 8.935547 C 19.93815 9.059245 20 9.205729 20 9.375 C 20 9.544271 19.93815 9.690756 19.814453 9.814453 C 19.690754 9.938151 19.54427 10 19.375 10 Z M 0.625 16.25 C 0.455729 16.25 0.309245 16.188152 0.185547 16.064453 C 0.061849 15.940756 0 15.794271 0 15.625 C 0 15.455729 0.061849 15.309245 0.185547 15.185547 C 0.309245 15.06185 0.455729 15 0.625 15 L 19.375 15 C 19.54427 15 19.690754 15.06185 19.814453 15.185547 C 19.93815 15.309245 20 15.455729 20 15.625 C 20 15.794271 19.93815 15.940756 19.814453 16.064453 C 19.690754 16.188152 19.54427 16.25 19.375 16.25 Z "
                        Foreground="#e4e4e4" />
                </ui:TitleBarButton>
                <ui:TitleBarButton
                    x:Name="btnHide"
                    Click="btnHide_Click"
                    ToolTip="Hide Borders">
                    <ui:PathIcon
                        Width="16"
                        Height="16"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Data="F1 M 0.625 0 C 0.794271 0 0.940755 0.06185 1.064453 0.185547 L 19.814453 18.935547 C 19.93815 19.059244 20 19.205729 20 19.375 C 20 19.544271 19.93815 19.690756 19.814453 19.814453 C 19.690754 19.93815 19.54427 20 19.375 20 C 19.205729 20 19.059244 19.93815 18.935547 19.814453 L 13.544922 14.433594 C 13.336588 14.720053 13.100586 14.975586 12.836914 15.200195 C 12.573242 15.424805 12.290039 15.615234 11.987305 15.771484 C 11.68457 15.927734 11.363932 16.046549 11.025391 16.12793 C 10.686849 16.209311 10.341797 16.25 9.990234 16.25 C 9.384766 16.25 8.816731 16.134441 8.286133 15.90332 C 7.755534 15.672201 7.293294 15.359701 6.899414 14.96582 C 6.505534 14.57194 6.193034 14.109701 5.961914 13.579102 C 5.730794 13.048503 5.615234 12.480469 5.615234 11.875 C 5.615234 11.165365 5.776367 10.499675 6.098633 9.87793 C 6.420898 9.256186 6.868489 8.736979 7.441406 8.320312 L 5.46875 6.347656 C 4.635417 6.888021 3.914388 7.548828 3.305664 8.330078 C 2.69694 9.111328 2.216797 9.967448 1.865234 10.898438 C 1.79362 11.08724 1.730143 11.276042 1.674805 11.464844 C 1.619466 11.653646 1.565755 11.842448 1.513672 12.03125 C 1.468099 12.174479 1.394857 12.291667 1.293945 12.382812 C 1.193034 12.473959 1.064453 12.519531 0.908203 12.519531 C 0.738932 12.519531 0.592448 12.457683 0.46875 12.333984 C 0.345052 12.210287 0.283203 12.063803 0.283203 11.894531 C 0.283203 11.861979 0.289714 11.813151 0.302734 11.748047 C 0.615234 10.472006 1.131185 9.290365 1.850586 8.203125 C 2.569987 7.115886 3.476562 6.197917 4.570312 5.449219 L 0.185547 1.064453 C 0.061849 0.940756 0 0.794271 0 0.625 C 0 0.45573 0.061849 0.309246 0.185547 0.185547 C 0.309245 0.06185 0.455729 0 0.625 0 Z M 8.339844 9.228516 C 7.877604 9.514975 7.516275 9.890951 7.255859 10.356445 C 6.995442 10.82194 6.865234 11.328125 6.865234 11.875 C 6.865234 12.304688 6.946614 12.709961 7.109375 13.09082 C 7.272135 13.47168 7.495117 13.803711 7.77832 14.086914 C 8.061523 14.370117 8.393555 14.5931 8.774414 14.755859 C 9.155273 14.91862 9.560547 15 9.990234 15 C 10.537109 15 11.043294 14.869792 11.508789 14.609375 C 11.974283 14.348959 12.353516 13.987631 12.646484 13.525391 Z M 10.449219 7.519531 C 10.963541 7.571615 11.445312 7.708334 11.894531 7.929688 C 12.343749 8.151042 12.740885 8.434245 13.085938 8.779297 C 13.430989 9.12435 13.714192 9.521484 13.935547 9.970703 C 14.1569 10.419922 14.293619 10.901693 14.345703 11.416016 Z M 7.119141 4.189453 C 8.043619 3.896484 9.00065 3.75 9.990234 3.75 C 11.18815 3.75 12.312825 3.953451 13.364258 4.360352 C 14.415689 4.767254 15.361327 5.328777 16.201172 6.044922 C 17.041016 6.761068 17.75716 7.604167 18.349609 8.574219 C 18.942057 9.544271 19.384766 10.595703 19.677734 11.728516 C 19.690754 11.79362 19.697266 11.845703 19.697266 11.884766 C 19.697266 12.054037 19.633789 12.198894 19.506836 12.319336 C 19.379883 12.439779 19.23177 12.5 19.0625 12.5 C 18.90625 12.5 18.780924 12.456055 18.686523 12.368164 C 18.592121 12.280273 18.518879 12.164714 18.466797 12.021484 C 18.421223 11.891276 18.383789 11.762695 18.354492 11.635742 C 18.325195 11.508789 18.28776 11.380209 18.242188 11.25 C 18.072916 10.748698 17.871094 10.266928 17.636719 9.804688 C 17.259113 9.088542 16.801758 8.434245 16.264648 7.841797 C 15.727539 7.24935 15.130208 6.743164 14.472656 6.323242 C 13.815104 5.90332 13.108724 5.5778 12.353516 5.34668 C 11.598307 5.115561 10.810547 5.000001 9.990234 5 C 9.677734 5.000001 9.366861 5.017904 9.057617 5.053711 C 8.748372 5.089519 8.440755 5.143229 8.134766 5.214844 Z "
                        Foreground="#e4e4e4" />
                </ui:TitleBarButton>
            </ui:SimpleStackPanel>
        </Grid>

        <Border
            Name="overlay"
            Grid.Row="1"
            Panel.ZIndex="1"
            Background="{StaticResource DarkColor}"
            Opacity="0.01" />
        <Border
            Name="FooterBar"
            Grid.Row="3"
            Panel.ZIndex="2"
            Background="{StaticResource DarkColor}"
            Opacity="0.1" />
    </Grid>
</Window>